import{c as l,G as p,M as d,H as w,W as u,I as m,B as b,p as f}from"./gameManager-D417MKQO.js";class K{constructor(t,s,i,o,h){this.x=t,this.y=s,this.w=i,this.h=o,this.force=h.mult(.35)}draw(){fill(255,255,255,125),rect(this.x,this.y,this.w,this.h),fill(255);let t=this.x+this.w/2,s=this.y+this.h/2;push(),translate(t,s),rotate(this.force.heading()),triangle(-5,-10,5,0,-5,10),pop()}isColliding(t){return l(t.pos.x,t.pos.y,t.r,this.x,this.y,this.w,this.h)}collide(t){t.applyForce(this.force)}}class r{constructor(t,s,i){this.pos=createVector(t,s),this.r=4,this.selected=!1,this.prevPos=createVector(t,s),this.parent=i}draw(){this.update(),push(),this.selected||this.pos.dist(mousePos)<this.r?(strokeWeight(1),stroke(0),fill(0,138,124)):fill(0,186,168),circle(this.pos.x,this.pos.y,this.r*2),pop()}update(){this.prevPos=this.pos.copy(),this.selected&&(this.pos=mousePos,this.parent.update(this,p5.Vector.sub(this.pos,this.prevPos)))}check(){return!mouseIsPressed&&this.selected&&(this.selected=!1),mouseIsPressed&&!this.selected&&this.pos.dist(mousePos)<this.r&&(this.selected=!0),this.selected}}class a{constructor(t,s=!0){this.obj=t,this.knot=new r(t.pos.x,t.pos.y,this),s&&main.staticKnots.push(this.knot)}draw(){this.obj.draw(),this.knot.draw()}update(){this.obj.pos=this.knot.pos}}class c extends r{constructor(t,s,i,o,h){super(t,s,i),this.originKnot=o,this.axis=h}originUpdate(t){this.pos.add(t)}update(){if(this.prevPos=this.pos.copy(),this.selected){const t=mousePos,s=p5.Vector.sub(t,this.originKnot.pos),i=p5.Vector.setMag(this.axis,s.dot(this.axis)/this.axis.mag()).add(this.originKnot.pos);this.pos=i,this.parent.update(this,p5.Vector.sub(this.pos,this.prevPos))}}}class n{constructor(t){this.obj=t,this.posKnot=new r(this.obj.x,this.obj.y,this),this.widthKnot=new c(this.obj.x+this.obj.w,this.obj.y,this,this.posKnot,createVector(1,0)),this.heightKnot=new c(this.obj.x,this.obj.y+this.obj.h,this,this.posKnot,createVector(0,1)),main.staticKnots.push(this.posKnot,this.widthKnot,this.heightKnot)}draw(){this.obj.draw(),this.posKnot.draw(),this.widthKnot.draw(),this.heightKnot.draw()}update(t,s){t==this.posKnot&&(this.widthKnot.originUpdate(s),this.heightKnot.originUpdate(s));const i=this.posKnot.pos;this.obj.x=i.x,this.obj.y=i.y,this.obj.w=this.widthKnot.pos.x-i.x,this.obj.h=this.heightKnot.pos.y-i.y}}class g extends p{constructor(){super(),this.hasSelected=!1,this.staticKnots=[]}init(){this.mainb=new a(new d(80,80),!1),this.hole=new a(new w(width-80,height-80),!1),this.balls.push(this.mainb)}draw(){background(123,255,123);for(const t of this.staticObjs)t.draw();this.hole.draw();for(const t of this.balls)t.draw();this.hasSelected||this.checkKnots()}checkKnots(){for(let t=this.balls.length-1;t>=0;t--)if(this.balls[t].knot.check()){this.hasSelected=!0;return}if(this.hole.knot.check()){this.hasSelected=!0;return}for(let t=this.staticKnots.length-1;t>=0;t--)if(this.staticKnots[t].check()){this.hasSelected=!0;return}}}const x=[{name:"Square Wall",create:(e,t)=>new n(new u(e,t,30,30))},{name:"Ice",create:(e,t)=>new n(new m(e,t,30,30))},{name:"Bouncer",create:(e,t)=>new a(new b(e,t))},{name:"Slope",create:(e,t)=>new n(new K(e,t,30,30,createVector(1,0)))}],j=document.querySelector(".object-template");for(const e of x){const t=document.createElement("button");t.textContent=e.name,t.addEventListener("click",()=>{const s=e.create(width/2,height/2);main.staticObjs.push(s)}),j.append(t)}window.p5=f;window.mousex=void 0;window.mousey=void 0;window.main=new g;window.setup=()=>{noStroke(),createCanvas(900,900).parent(document.querySelector(".canvas-content")),main.init()};window.draw=()=>{window.mousePos=createVector(mouseX,mouseY),main.draw()};window.mouseReleased=()=>{main.hasSelected=!1};
